/**
 * Copyright 2021 Luigi Cavalieri.
 * @license GPL v3.0 (https://opensource.org/licenses/GPL-3.0).
 * *************************************************************** */
function SiteTreeSetting(e){this.id="sitetree-"+e,this._target=document.getElementById(this.id),this._jqTarget=null,this._row=null}function SiteTreePingUI(e){this.mouseIsOn=!1,this.isVisible=!1,this.pingingUI=e,this.pingingBubble=e.getElementsByClassName("sitetree-ap-bubble")[0],this.statusMessages={};var i=this,t=e.getElementsByClassName("sitetree-ap-switch-control");jQuery(e).hover(function(){i.show()},function(){i.hide()}),t.length&&(this.switchControl=t[0],this.switchControl.onchange=function(){var t={action:"handleSiteTreeAdminAjaxRequest",sitetree_action:"enable_automatic_pinging",enable_ap:Number(this.checked)};jQuery.post(ajaxurl,t,function(e){return"ok"==e&&("on"in i.statusMessages||(i.statusMessages={on:i.pingingBubble.getElementsByClassName("sitetree-ap-on-status-msg")[0],off:i.pingingBubble.getElementsByClassName("sitetree-ap-off-status-msg")[0]}),void(t.enable_ap?i.toggleStatus("off"):i.toggleStatus("on")))}).fail(function(){i.switchControl.checked=!1})})}SiteTreeSetting.prototype.value=function(){return this._target?this._target.value:null},SiteTreeSetting.prototype.disable=function(e){if(!this._target)return!1;this._target.disabled=e=void 0===e?!0:e},SiteTreeSetting.prototype.bindEvent=function(e,t){this._jqTarget||(this._jqTarget=jQuery(this._target)),this._jqTarget.on(e,t)},SiteTreeSetting.prototype.isChecked=function(){return this._target?this._target.checked:null},SiteTreeSetting.prototype.hide=function(e){if(!this._target)return!1;this._row||(this._row=this._target.parentNode.parentNode),this._row.style.display=e||void 0===e?"none":"table-row"},SiteTreeSetting.prototype.toggle=function(){if(!this._target)return!1;this._row||(this._row=this._target.parentNode.parentNode),"none"==this._row.style.display?this._row.style.display="table-row":this._row.style.display="none"},SiteTreePingUI.prototype.toggleStatus=function(e){var t="on"==e?"off":"on",i="sitetree-automatic-pinging-",s=i+e,i=i+t;this.pingingUI.classList.replace(s,i),this.pingingBubble.classList.replace(s,i),this.statusMessages[e].style.display="none",this.statusMessages[t].style.display="inline-block"},SiteTreePingUI.prototype.show=function(){this.mouseIsOn=!0,this.isVisible||(this.isVisible=!0,this.pingingBubble.style.display="block")},SiteTreePingUI.prototype.hide=function(){this.mouseIsOn=!1,setTimeout(function(e){e.mouseIsOn||(e.isVisible=!1,e.pingingBubble.style.display="none")},800,this)};var SiteTree=function(_){return{init:function(e,t){switch(e){case"sitetree-dashboard":var i,s,n,r,a,o,l,h,u=document.getElementById("sitetree-page-for-site-tree");u&&("0"===u.value&&((i=document.getElementById("sitetree-primary-site_tree-form-btn")).disabled=!0,u.onchange=function(){i.disabled="0"===u.value}),n=s=null,r=!1,a=document.getElementById("site-tree-content-types-fieldset"),o=a.parentElement,l=document.createElement("div"),(h=document.createElement("a")).innerHTML=t.sftEnableBtnTitle,h.id="sitetree-sft-enable-btn",h.setAttribute("href","#"),h.onclick=function(){return r?(r=!1,_(a).sortable("destroy"),this.id="sitetree-sft-enable-btn",this.innerHTML=t.sftEnableBtnTitle,l.removeChild(s),o.classList.remove("sitetree-sortable"),o.parentElement.removeChild(n)):(r=!0,s||((s=document.createElement("input")).id="sitetree-sft-save-btn",s.setAttribute("type","submit"),s.setAttribute("name","save_order"),s.setAttribute("value",t.sftSaveBtnTitle),(n=document.createElement("p")).innerHTML="<small>"+t.sortableFieldsetTooltip+"</small>"),_(a).sortable({change:function(e,t){s.disabled=!1}}),this.id="sitetree-sft-cancel-btn",this.innerHTML=t.sftCancelBtnTitle,s.disabled=!0,l.appendChild(s),o.classList.add("sitetree-sortable"),o.parentElement.appendChild(n)),this.blur(),!1},l.id="sitetree-sortable-fieldset-toolbar",l.appendChild(h),o.parentElement.insertBefore(l,o));var g=[],c=document.getElementsByClassName("sitetree-automatic-pinging-ui");if(c)for(var d=0;d<c.length;d++)g[d]=new SiteTreePingUI(c[d]);break;case"sitetree-site_tree":for(var p={},b=["page-exclude-children","page-hierarchical","post-group-by","post-order-by","authors-show-avatar","authors-avatar-size"],d=0;d<b.length;d++)p[b[d].replace(/-/g,"_")]=new SiteTreeSetting(b[d]);p.page_exclude_children.isChecked()&&p.page_hierarchical.hide(),p.authors_show_avatar.isChecked()||p.authors_avatar_size.hide(),"date"==p.post_group_by.value()&&p.post_order_by.hide(),p.page_exclude_children.bindEvent("click",function(){p.page_hierarchical.toggle()}),p.authors_show_avatar.bindEvent("click",function(){p.authors_avatar_size.toggle()}),p.post_group_by.bindEvent("change",function(){p.post_order_by.hide("date"==this.value)})}}}}(jQuery);